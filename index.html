<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interactive 3-Option Quiz (Text + Image Mixed)</title>
  <style>
    :root {
      /* Higher-contrast palette */
      --bg: #0b0f1a;        /* darker background */
      --card: #0b1220;      /* darker card */
      --text: #ffffff;      /* pure white text */
      --muted: #dbe2ea;     /* brighter muted text */
      --ok: #22c55e;        /* success */
      --err: #ef4444;       /* error */
      --pri: #1d4ed8;       /* stronger blue */
      --border: rgba(255,255,255,.2);
      --surface: rgba(255,255,255,.08);
    }

    /* Optional high-contrast toggle overrides */
    body.hc{
      --bg:#000; --card:#000; --text:#fff; --muted:#f3f4f6; --pri:#0ea5e9; --border:rgba(255,255,255,.35); --surface:rgba(255,255,255,.12);
    }

    *{box-sizing:border-box}
    html{color-scheme:dark}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial;
      background: var(--bg); color: var(--text); min-height:100vh; margin:0;
      display:grid; place-items:center; padding:18px; line-height:1.5;
      -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
    }
    @media (max-width: 480px){ body{ padding:14px; } }

    .app{width:100%; max-width:900px; background: var(--card); border-radius:16px; box-shadow:0 12px 30px rgba(0,0,0,.6); overflow:hidden; border:1px solid var(--border)}
    header, footer{display:flex; justify-content:space-between; align-items:center; gap:12px; padding:14px 18px; border-bottom:1px solid var(--border)}
    footer{border-top:1px solid var(--border); border-bottom:none}
    .title{font-weight:800; letter-spacing:.2px}
    .muted{color:var(--muted)}
    main{padding:18px}

    .question{font-size:clamp(20px,3.2vw,26px); font-weight:750}
    .note{color:var(--muted); margin-top:6px}

    .grid{display:grid; gap:14px; margin-top:16px; grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:820px){.grid{grid-template-columns:1fr}}

    .option{position:relative; border:1px solid var(--border); background: var(--surface); border-radius:14px; cursor:pointer; padding:12px; text-align:left; transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease}
    .option:hover{transform:translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,.5)}

    .thumb{width:100%; aspect-ratio:16/10; object-fit:cover; background:#0b1220; border-radius:10px; border:1px solid var(--border); display:block}
    .label{font-weight:700; margin-top:10px; font-size:18px}
    .option.text-only{display:flex; align-items:center; min-height:64px; padding:16px}
    .option.text-only .label{margin:0; font-size:18px}

    .option:focus-visible{outline:3px solid rgba(14,165,233,.85); outline-offset:2px}

    .option[data-state="correct"]{border-color: rgba(34,197,94,.9); box-shadow:0 0 0 3px rgba(34,197,94,.25) inset}
    .option[data-state="wrong"]{border-color: rgba(239,68,68,.9); box-shadow:0 0 0 3px rgba(239,68,68,.25) inset}

    .row{display:flex; gap:10px; justify-content:space-between; align-items:center; margin-top:16px}
    .pill{padding:8px 12px; border-radius:999px; background: rgba(255,255,255,.12); color:var(--muted); font-size:14px; border:1px solid var(--border)}

    .btn{appearance:none; border:1px solid var(--border); border-radius:12px; padding:12px 16px; font-weight:800; cursor:pointer}
    .btn.primary{background: var(--pri); color:#fff; border-color: transparent; box-shadow:0 8px 22px rgba(29,78,216,.35)}
    .btn.secondary{background: rgba(255,255,255,.06); color: var(--text)}
    .btn:focus-visible{outline:3px solid rgba(14,165,233,.85); outline-offset:2px}

    .feedback{margin-top:12px; font-weight:800}
    .correct{color:var(--ok)}
    .incorrect{color:var(--err)}
    .hide{display:none!important}

    .progress{width:240px; height:12px; background:#334155; border-radius:999px; overflow:hidden; border:1px solid var(--border)}
    .progress>div{height:100%; width:0%; background:linear-gradient(90deg,#60a5fa,#34d399); transition:width .3s ease}

    /* Small-screen readability boosts */
    @media (max-width:480px){
      .label{font-size:18px}
      .muted{font-size:15px}
      .btn{padding:14px 18px}
    }

    /* Contrast toggle button */
    .toggle{display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:10px; background:rgba(255,255,255,.08); border:1px solid var(--border); cursor:pointer; font-weight:700}
  </style>
</head>
<body>
  <div class="app" role="application">
    <header>
      <div>
        <div class="title">Mixed Quiz (3 options)</div>
        <div class="muted" id="progressLabel">Question 1</div>
      </div>
      <div style="display:flex; align-items:center; gap:10px;">
        <button id="contrastBtn" class="toggle" title="Toggle high-contrast">High contrast</button>
        <div class="progress" aria-label="Quiz progress"><div id="progressBar"></div></div>
      </div>
    </header>

    <main>
      <div id="card">
        <div class="question" id="questionText">Loading...</div>
        <div class="note" id="questionNote"></div>
        <div class="grid" id="optionsGrid" role="group" aria-label="Answers"></div>
        <div class="feedback" id="feedback"></div>
        <div class="row">
          <span class="pill" id="scorePill">Score: 0</span>
          <div>
            <button class="btn secondary" id="skipBtn">Skip</button>
            <button class="btn primary" id="nextBtn" disabled>Next</button>
          </div>
        </div>
      </div>

      <div id="result" class="hide">
        <h2 style="margin:0 0 8px 0">All done! üéâ</h2>
        <p class="muted" id="resultSummary"></p>
        <div class="row" style="margin-top: 16px;">
          <button class="btn primary" id="restartBtn">Restart Quiz</button>
          <button class="btn secondary" id="reviewBtn">Review Answers</button>
        </div>
        <div id="review" class="hide" style="margin-top:14px"></div>
      </div>
    </main>

    <footer>
      <span class="muted">Tip: Click or use 1/2/3 keys to answer.</span>
      <span class="muted">Good luck</span>
    </footer>
  </div>

  <script>
    // Mix text-only and image options freely. Each question still has exactly 3 options.

    const QUESTIONS = [
      {
        prompt: "Quale di queste tecniche usa radiazioni ionizzanti?",
        note: "Confronto tra TC, RM ed ecografia",
        options: [
          { text: "Risonanza Magnetica (RM)", correct: false },
          { text: "Tomografia Computerizzata (TC)", correct: true },
          { text: "Ecografia", correct: false },
        ]
      },
      {
        prompt: "In RM, l‚Äôintensit√† del campo magnetico si misura in‚Ä¶",
        note: "Unit√† di misura",
        options: [
          { text: "Gray (Gy)", correct: false },
          { text: "Tesla (T)", correct: true },
          { text: "Sievert (Sv)", correct: false },
        ]
      },
      {
        prompt: "Il Gray (Gy) misura‚Ä¶",
        note: "Dosimetria di base",
        options: [
          { text: "La dose assorbita", correct: true },
          { text: "L‚Äôattivit√† di una sorgente", correct: false },
          { text: "La dose efficace", correct: false },
        ]
      },
      {
        prompt: "Quale delle seguenti immagini √® una TC?",
        note: "Image options example",
        options: [
          { text: "A", img: "A.png", correct: true },
          { text: "B", img: "B.png", correct: false },
          { text: "C", img: "C.png", correct: false },
        ]
      },
      {
        prompt: "In ecografia, l‚Äôimmagine si ottiene grazie a‚Ä¶",
        note: "Principio fisico",
        options: [
          { text: "Onde acustiche ad alta frequenza", correct: true },
          { text: "Raggi X", correct: false },
          { text: "Particelle beta", correct: false },
        ]
      },
      {
        prompt: "In PET si rivelano principalmente‚Ä¶",
        note: "Nucleare in medicina",
        options: [
          { text: "Coppie di fotoni gamma da annichilazione positrone-elettrone", correct: true },
          { text: "Onde ultrasonore riflesse", correct: false },
          { text: "Emissione di luce visibile dai tessuti", correct: false },
        ]
      },
      {
        prompt: "Quale di questi esami espone tipicamente alla dose efficace pi√π bassa?",
        note: "Ordini di grandezza (indicativi)",
        options: [
          { text: "Radiografia del torace", correct: true },
          { text: "TC addome", correct: false },
          { text: "PET/TC corpo intero", correct: false },
        ]
      },
      {
        prompt: "Quale delle seguenti immagini √® stata acquisita tramite raggi-X?",
        note: "Image options example 2",
        options: [
          { text: "A", img: "RX.png", correct: true },
          { text: "B", img: "CT.png", correct: false },
          { text: "C", img: "MRI.png", correct: false },
        ]
      },
      {
        prompt: "Nella TC, l‚Äôunit√† di misura dell‚Äôattenuazione √®‚Ä¶",
        note: "Scala di densit√†",
        options: [
          { text: "Unit√† Hounsfield (HU)", correct: true },
          { text: "Unit√† Tesla (T)", correct: false },
          { text: "Unit√† Becquerel (Bq)", correct: false },
        ]
      },
      {
        prompt: "Quale mezzo di contrasto √® tipico della RM?",
        note: "Contrasti in imaging",
        options: [
          { text: "Agenti a base di gadolinio", correct: true },
          { text: "Agenti a base di iodio", correct: false },
          { text: "Solfato di bario", correct: false },
        ]
      },
      {
        prompt: "Perch√© si usano schermature (es. grembiuli) in radiografia?",
        note: "Protezione dei tessuti sensibili",
        options: [
          { text: "Per ridurre la dose a organi sensibili vicini all‚Äôarea esaminata", correct: true },
          { text: "Per aumentare il contrasto dell‚Äôimmagine", correct: false },
          { text: "Per velocizzare l‚Äôacquisizione", correct: false },
        ]
      },
      {
        prompt: "Quale √® una controindicazione assoluta alla RM?",
        note: "Sicurezza in RM",
        options: [
          { text: "Pacemaker non compatibile con RM", correct: true },
          { text: "Protesi in titanio", correct: false },
          { text: "Otturazioni dentarie", correct: false },
        ]
      },

    ];

    // --- State ---
    let index = 0; let score = 0; let locked = false; const history = [];

    // --- Elements ---
    const progressLabel = document.getElementById('progressLabel');
    const progressBar   = document.getElementById('progressBar');
    const questionText  = document.getElementById('questionText');
    const questionNote  = document.getElementById('questionNote');
    const optionsGrid   = document.getElementById('optionsGrid');
    const feedbackEl    = document.getElementById('feedback');
    const nextBtn       = document.getElementById('nextBtn');
    const skipBtn       = document.getElementById('skipBtn');
    const scorePill     = document.getElementById('scorePill');
    const result        = document.getElementById('result');
    const card          = document.getElementById('card');
    const resultSummary = document.getElementById('resultSummary');
    const restartBtn    = document.getElementById('restartBtn');
    const reviewBtn     = document.getElementById('reviewBtn');
    const reviewBox     = document.getElementById('review');
    const contrastBtn   = document.getElementById('contrastBtn');

    function shuffle(arr){return arr.map(v=>({v,r:Math.random()})).sort((a,b)=>a.r-b.r).map(({v})=>v)}

    function updateProgress(){
      progressLabel.textContent = `Question ${index+1} of ${QUESTIONS.length}`;
      progressBar.style.width = `${(index/QUESTIONS.length)*100}%`;
      scorePill.textContent = `Score: ${score}`;
    }

    function renderQuestion(){
      locked = false; feedbackEl.textContent = ''; nextBtn.disabled = true; optionsGrid.innerHTML = '';
      const q = QUESTIONS[index];
      questionText.textContent = q.prompt; questionNote.textContent = q.note || '';

      const opts = shuffle(q.options.map((o,i)=>({...o, idx:i})));
      opts.forEach((opt, position)=>{
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'option' + (opt.img ? '' : ' text-only');
        btn.setAttribute('data-idx', opt.idx);
        btn.setAttribute('data-correct', !!opt.correct);
        btn.innerHTML = opt.img
          ? `<img class="thumb" src="${opt.img}" alt="${opt.text}"><div class="label">${position+1}. ${opt.text}</div>`
          : `<div class="label">${position+1}. ${opt.text}</div>`;
        btn.addEventListener('click', ()=>selectOption(btn));
        optionsGrid.appendChild(btn);
      });
      updateProgress();
    }

    function selectOption(btn){
      if(locked) return; locked = true;
      const isCorrect = btn.getAttribute('data-correct') === 'true';
      // decorate all options
      optionsGrid.querySelectorAll('.option').forEach(el=>{
        const corr = el.getAttribute('data-correct')==='true';
        el.dataset.state = corr ? 'correct' : (el===btn ? 'wrong' : '');
      });

      if(isCorrect){feedbackEl.textContent='Correct!'; feedbackEl.className='feedback correct'; score++;}
      else{const q=QUESTIONS[index]; const corrLabel=q.options.find(o=>o.correct)?.text||'the correct answer'; feedbackEl.textContent=`Not quite. Correct: ${corrLabel}`; feedbackEl.className='feedback incorrect';}

      history.push({qIndex:index, selected:Number(btn.getAttribute('data-idx')), correct:isCorrect});
      scorePill.textContent = `Score: ${score}`; nextBtn.disabled = false;
      progressBar.style.width = `${((index+1)/QUESTIONS.length)*100}%`;
    }

    function nextQuestion(){ if(index < QUESTIONS.length-1){ index++; renderQuestion(); } else { showResult(); } }
    function skipQuestion(){ if(locked) return; history.push({qIndex:index, selected:null, correct:false, skipped:true}); nextQuestion(); }

    function showResult(){
      card.classList.add('hide'); result.classList.remove('hide');
      resultSummary.textContent = `You scored ${score} out of ${QUESTIONS.length}.`;
      progressLabel.textContent = 'Quiz complete'; progressBar.style.width = '100%';
    }

    function restart(){ index=0; score=0; locked=false; history.length=0; card.classList.remove('hide'); result.classList.add('hide'); renderQuestion(); }

    function renderReview(){
      const parts = history.map((h,i)=>{ const q=QUESTIONS[h.qIndex]; const corrIdx=q.options.findIndex(o=>o.correct); const selText=h.selected==null?'‚Äî':q.options[h.selected]?.text; const corrText=q.options[corrIdx]?.text; const status=h.correct?'‚úÖ':(h.skipped?'‚è≠Ô∏è':'‚ùå'); return `<div style="padding:10px 12px; border:1px solid var(--border); border-radius:12px; margin-bottom:10px;">\n<div style=\"font-weight:800\">Q${i+1}. ${q.prompt}</div>\n<div class=\"muted\">Your answer: <b>${selText}</b> ‚Ä¢ Correct: <b>${corrText}</b> ${status}</div></div>`; }).join('');
      reviewBox.innerHTML = parts || '<div class="muted">No answers to review.</div>'; reviewBox.classList.remove('hide');
    }

    // Keyboard: 1/2/3, Enter, S
    document.addEventListener('keydown', (e)=>{
      if(!result.classList.contains('hide')) return;
      if(['1','2','3'].includes(e.key)){ const idx = Number(e.key)-1; const btn = optionsGrid.querySelectorAll('.option')[idx]; if(btn) btn.click(); }
      else if(e.key==='Enter'){ if(!nextBtn.disabled) nextBtn.click(); }
      else if(e.key.toLowerCase()==='s'){ skipBtn.click(); }
    });

    nextBtn.addEventListener('click', nextQuestion);
    skipBtn.addEventListener('click', skipQuestion);
    restartBtn.addEventListener('click', restart);
    reviewBtn.addEventListener('click', renderReview);

    // High-contrast toggle
    contrastBtn.addEventListener('click', () => {
      document.body.classList.toggle('hc');
      contrastBtn.textContent = document.body.classList.contains('hc') ? 'Standard contrast' : 'High contrast';
    });

    renderQuestion();
  </script>
</body>
</html>
